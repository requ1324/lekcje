<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Custom Range Slider</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
      body {
        margin: 0;
        padding: 50px;
        font-family: Arial, sans-serif;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }

      .slider-container {
        width: 200px;
        margin: 60px 0;
      }

      .slider-track {
        width: 100%;
        height: 10px;
        background: #ddd;
        position: relative;
        cursor: pointer;
      }

      .slider-fill {
        height: 100%;
        background: rgb(43, 43, 169);
        width: 50%;
      }

      .slider-thumb {
        width: 20px;
        height: 20px;
        background: rgb(34, 34, 34);
        position: absolute;
        top: -5px;
        left: 50%;
        cursor: pointer;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        text-align: center;
      }
      td {
        margin: 20px;
        border: 2px solid black;
        padding: 10px;
      }
      tr {
        margin: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <button id="btn">Generuj</button>
    </div>

    <script>
      $(document).ready(function () {
        let isDragging = false;
        let currentSlider = null;

        let sliders = [
          { name: "red", color: "red", value: 50 },
          { name: "blue", color: "blue", value: 50 },
          { name: "green", color: "green", value: 50 },
        ];

        function updateSlider(trackId, e) {
          let track = $("#" + trackId);
          let x = e.clientX - track.offset().left;
          let width = track.width();
          let percent = (x / width) * 100;

          percent = Math.max(0, Math.min(100, percent));

          let fillId = trackId.replace("track", "fill");
          let thumbId = trackId.replace("track", "thumb");
          let valueId = trackId.replace("track", "val");

          $("#" + fillId).css("width", percent + "%");
          $("#" + thumbId).css("left", percent + "%");
          $("#" + valueId).text(Math.round(percent));

          return percent;
        }

        $("#btn").on("click", function () {
          let table = $("<table>");
          for (let i = 0; i < sliders.length; i++) {
            let tr = $("<tr>");

            let td1 = $("<td>");
            let td2 = $("<td>").addClass("slider-container");
            let td3 = $("<td>");

            td1.text(sliders[i].name);

            let trackId = "track" + i;
            let fillId = "fill" + i;
            let thumbId = "thumb" + i;
            let valId = "val" + i;

            let track = $("<div>")
              .addClass("slider-track")
              .attr("id", trackId)
              .css("background", sliders[i].color);
            let fill = $("<div>")
              .addClass("slider-fill")
              .attr("id", fillId)
              .css("width", sliders[i].value + "%")
              .css("background", sliders[i].color);
            let thumb = $("<div>")
              .addClass("slider-thumb")
              .attr("id", thumbId)
              .css("left", sliders[i].value + "%");

            track.append(fill).append(thumb);
            td2.append(track);

            td3.attr("id", valId).text(sliders[i].value);
            tr.append(td1).append(td2).append(td3);

            table.append(tr);
          }

          $(".container").append(table);

          // Po wygenerowaniu, podpinamy eventy
          $(".slider-thumb").on("mousedown", function () {
            currentSlider = $(this).parent().attr("id");
            isDragging = true;
          });

          $(".slider-track").on("mousedown", function (e) {
            if (!$(e.target).hasClass("slider-thumb")) {
              currentSlider = $(this).attr("id");
              updateSlider(currentSlider, e);
            }
          });
        });

        $(document).on("mousemove", function (e) {
          if (isDragging && currentSlider) {
            updateSlider(currentSlider, e);
          }
        });

        $(document).on("mouseup", function () {
          isDragging = false;
          currentSlider = null;
        });
      });
    </script>
  </body>
</html>
