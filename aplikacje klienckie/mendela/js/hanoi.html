<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wie≈ºe Hanoi</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
      }

      #game-board {
        display: flex;
        justify-content: space-around;
        width: 80%;
        max-width: 900px;
        margin-bottom: 30px;
      }

      .tower {
        width: 30%;
        height: 300px;
        background-color: #eee;
        border: 2px solid #333;
        border-bottom: none;

        /* Ustawienie s≈Çupka */
        position: relative;
        display: flex;
        flex-direction: column-reverse; /* Stosy rosnƒÖ od do≈Çu do g√≥ry */
        align-items: center;
        justify-content: flex-start; /* Diski na dole */
        padding-top: 10px;
        cursor: pointer;
      }

      /* Linia bazowa s≈Çupka */
      .tower::after {
        content: "";
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 15px;
        background-color: #333;
      }

      /* Centralny palik */
      .tower::before {
        content: "";
        position: absolute;
        bottom: 15px;
        width: 8px;
        height: calc(100% - 15px);
        background-color: #555;
      }

      /* Styl wybranej wie≈ºy */
      .tower.selected {
        background-color: #c8e6c9;
        box-shadow: 0 0 10px #4caf50;
      }

      .disk {
        height: 30px;
        margin-bottom: 2px;
        background-color: #007bff;
        border: 1px solid #0056b3;
        text-align: center;
        line-height: 30px;
        color: white;
        z-index: 10;
        transition: all 0.2s ease-in-out;
        box-sizing: border-box;
        border-radius: 5px;
      }

      .disk-1 {
        width: 60px;
        background-color: #2196f3;
      }
      .disk-2 {
        width: 90px;
        background-color: #4caf50;
      }
      .disk-3 {
        width: 120px;
        background-color: #ff9800;
      }

      .disk-label {
        position: absolute;
        top: -20px;
        font-weight: bold;
      }

      #message {
        margin-top: 20px;
        font-size: 1.5em;
        color: darkred;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>Wie≈ºe Hanoi (3 dyski)</h1>
    <div id="message"></div>

    <div id="game-board">
      <div id="A" class="tower">
        <span class="disk-label">Wie≈ºa A (≈πr√≥d≈Çowa)</span>
      </div>
      <div id="B" class="tower">
        <span class="disk-label">Wie≈ºa B</span>
      </div>
      <div id="C" class="tower">
        <span class="disk-label">Wie≈ºa C (Docelowa)</span>
      </div>
    </div>

    <button onclick="startGame()">Restart Gry</button>

    <script>
      // Data structure representing the towers (stack logic: last element is the top disk)
      let towers = {};
      let selectedTowerId = null; // Przechowuje ID wie≈ºy (A, B, C) klikniƒôtej jako ≈∫r√≥d≈Ço

      const WIN_TOWER = "C";
      const NUM_DISKS = 3;

      // Inicjalizacja gry i stanu
      function startGame() {
        // Wymaganie: na wie≈ºy A le≈ºƒÖ dyski 3, 2, 1 (1 = najmniejszy, ostatni w array to g√≥ra)
        towers = {
          A: [3, 2, 1],
          B: [],
          C: [],
        };
        console.log(towers["A"]);
        selectedTowerId = null;
        document.getElementById("message").textContent = "";
        renderTowers();
      }

      // Rysowanie dysk√≥w na podstawie stanu tablicy 'towers'
      function renderTowers() {
        ["A", "B", "C"].forEach((id) => {
          const towerElement = document.getElementById(id);
          // Usu≈Ñ wszystkie stare dyski (opr√≥cz etykiety)
          towerElement
            .querySelectorAll(".disk")
            .forEach((disk) => disk.remove());
          console.log(id);
          // Sprawd≈∫, czy wie≈ºa jest wybrana i dodaj/usu≈Ñ klasƒô 'selected'
          if (id === selectedTowerId) {
            towerElement.classList.add("selected");
          } else {
            towerElement.classList.remove("selected");
          }

          // Rysowanie nowych dysk√≥w
          towers[id].forEach((diskSize) => {
            const disk = document.createElement("div");
            disk.classList.add("disk", `disk-${diskSize}`);
            disk.textContent = diskSize; // Numeracja kolejnych krok√≥w ≈õcie≈ºki (w tym przypadku numer dysku)
            towerElement.appendChild(disk);
          });
        });
      }

      // G≈Ç√≥wna logika gry - obs≈Çuga klikniƒôcia wie≈ºy
      function handleTowerClick(towerId) {
        const towerElement = document.getElementById(towerId);

        if (selectedTowerId === null) {
          // Krok 1: Wybrano wie≈ºƒô ≈∫r√≥d≈ÇowƒÖ

          // Wymaganie: mo≈ºna przenie≈õƒá tylko ostatni element (musi istnieƒá)
          if (towers[towerId].length === 0) {
            document.getElementById("message").textContent =
              "Wie≈ºa pusta. Wybierz innƒÖ wie≈ºƒô.";
            return;
          }

          selectedTowerId = towerId;
          document.getElementById(
            "message"
          ).textContent = `Wybrano wie≈ºƒô ${towerId}. Kliknij wie≈ºƒô docelowƒÖ.`;
          renderTowers(); // Pod≈õwietl wybranƒÖ wie≈ºƒô
        } else {
          // Krok 2: Wybrano wie≈ºƒô docelowƒÖ

          const sourceId = selectedTowerId;
          const destId = towerId;

          // Anulowanie wyboru, je≈õli klikniƒôto tƒô samƒÖ wie≈ºƒô
          if (sourceId === destId) {
            selectedTowerId = null;
            document.getElementById("message").textContent = "Anulowano wyb√≥r.";
            renderTowers();
            return;
          }

          const sourceDisks = towers[sourceId];
          const destDisks = towers[destId];

          // Wymaganie: mo≈ºna przenie≈õƒá tylko ostatni element wie≈ºy
          const diskToMove = sourceDisks[sourceDisks.length - 1];

          // Wymaganie: nie wolno po≈Ço≈ºyƒá wiƒôkszego dysku na mniejszy
          const topDestDisk = destDisks[destDisks.length - 1];

          if (topDestDisk !== undefined && diskToMove > topDestDisk) {
            document.getElementById(
              "message"
            ).textContent = `B≈ÇƒÖd: Nie mo≈ºna po≈Ço≈ºyƒá dysku ${diskToMove} na mniejszy dysk ${topDestDisk}.`;
            // Reset wyboru po b≈Çƒôdnym ruchu
            selectedTowerId = null;
            renderTowers();
            return;
          }

          // Poprawny ruch
          sourceDisks.pop(); // Zdejmij z wie≈ºy ≈∫r√≥d≈Çowej
          destDisks.push(diskToMove); // Po≈Ç√≥≈º na wie≈ºy docelowej

          selectedTowerId = null;
          document.getElementById(
            "message"
          ).textContent = `Przeniesiono dysk ${diskToMove} z ${sourceId} do ${destId}.`;
          renderTowers();

          // Sprawd≈∫ warunek wygranej
          checkWin();
        }
      }

      // Sprawdzenie warunku wygranej
      function checkWin() {
        // Wymaganie: gdy ca≈Ça wie≈ºa znajdzie siƒô na C, wy≈õwietl komunikat
        if (towers[WIN_TOWER].length === NUM_DISKS) {
          document.getElementById("message").textContent =
            "üéâ GRATULACJE! WYGRA≈ÅE≈ö! üéâ";
          // Usu≈Ñ event listenery, aby zablokowaƒá dalsze ruchy
          document
            .querySelectorAll(".tower")
            .forEach((t) => (t.onclick = null));
        }
      }

      // Dodanie obs≈Çugi zdarze≈Ñ po za≈Çadowaniu skryptu
      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("A").onclick = () => handleTowerClick("A");
        document.getElementById("B").onclick = () => handleTowerClick("B");
        document.getElementById("C").onclick = () => handleTowerClick("C");

        startGame(); // Rozpocznij grƒô po za≈Çadowaniu
      });
    </script>
  </body>
</html>
